---
title: "Analysis"
output: 
  html_document:
    toc: true
    toc_float: true
---
```{r}
library(tidyverse)
```

##2015-2020 total death by year
```{r}
year_plot = 
  data_hist %>% 
  filter(year > 2014) %>% 
  group_by(year) %>%
  mutate(count = n()) %>% 
  ggplot(aes(x = year, y = count)) + 
  geom_point() +
  labs(x = "Year",
       y = "Total death"
       )

year_plot
```

##2015-2020 total death by perpetrator’s sex
```{r}
sex_plot = 
  data_hist %>% 
  filter(year > 2014,
         perp_sex != "unknown") %>% 
  group_by(year, perp_sex) %>%
  mutate(n = n()) %>% 
  ggplot(aes(x = year, group = n, fill = perp_sex)) + 
  geom_bar(position = "dodge") 
  
sex_plot
```

##2015-2020 total death by perpetrator’s race
```{r}
race_plot = 
  data_hist %>% 
  filter(year > 2014,
         perp_race != "unknown") %>% 
  group_by(perp_race) %>%
  mutate(n = n()) %>% 
  ggplot(aes(x = perp_race, group = n)) + 
  geom_bar(position = "dodge") 
  
race_plot
```

##2015-2020 total death by boro
```{r}
boro_plot = 
  data_hist %>% 
  filter(year > 2014) %>% 
  group_by(boro) %>%
  mutate(n = n()) %>% 
  ggplot(aes(x = boro, group = n)) + 
  geom_bar(position = "dodge") 

boro_plot
```

